<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NFCä½ç½®å·¥å…·</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    :root {
      /* äº®è‰²ä¸»é¢˜å˜é‡ */
      --primary-color: #1a73e8;
      --primary-hover: #1557b0;
      --secondary-color: #5f6368;
      --border-color: #dadce0;
      --background-light: #f8f9fa;
      --background-main: white;
      --text-primary: #202124;
      --text-secondary: #5f6368;
      --error-color: #d93025;
      --success-color: #188038;
      --warning-bg: #fff3e0;
      --warning-border: #ffcc80;
    }

    /* æš—è‰²ä¸»é¢˜å˜é‡ */
    [data-theme="dark"] {
      --primary-color: #8ab4f8;
      --primary-hover: #aecbfa;
      --secondary-color: #9aa0a6;
      --border-color: #3c4043;
      --background-light: #202124;
      --background-main: #292a2d;
      --text-primary: #e8eaed;
      --text-secondary: #9aa0a6;
      --error-color: #f28b82;
      --success-color: #81c995;
      --warning-bg: #3c2a1e;
      --warning-border: #85622c;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      line-height: 1.6;
      color: var(--text-primary);
      background-color: var(--background-light);
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background-color: var(--background-main);
      border-radius: 8px;
      box-shadow: 0 1px 2px 0 rgba(60, 64, 67, 0.3), 0 2px 6px 2px rgba(60, 64, 67, 0.15);
      display: grid;
      grid-template-columns: 1fr 300px;
      gap: 20px;
    }

    .main-content {
      padding-right: 20px;
      border-right: 1px solid var(--border-color);
    }

    .instructions {
      padding: 20px;
      background-color: var(--background-light);
      border-radius: 8px;
      position: sticky;
      top: 20px;
      max-height: calc(100vh - 40px);
      overflow-y: auto;
    }

    .instruction-content {
      display: none;
      opacity: 0;
      transition: opacity 0.3s ease-in-out;
    }

    .instruction-content.active {
      display: block;
      opacity: 1;
    }

    .instructions h2 {
      margin-bottom: 15px;
      font-size: 18px;
      color: var(--text-primary);
    }

    .instructions ol {
      padding-left: 20px;
    }

    .instructions li {
      margin-bottom: 10px;
      font-size: 14px;
      color: var(--text-secondary);
    }

    .header {
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid var(--border-color);
    }

    .header h1 {
      font-size: 24px;
      color: var(--text-primary);
      margin-bottom: 10px;
      font-weight: 500;
    }

    .upload-section {
      margin-bottom: 20px;
      padding: 24px;
      background-color: var(--background-main);
      border-radius: 8px;
      border: 2px dashed var(--border-color);
    }

    /* è¾“å…¥æ¡†ç»„æ ·å¼ */
    .input-group {
      margin-bottom: 15px;
      padding: 10px;
      background-color: var(--background-main);
      border-radius: 4px;
    }

    .input-group label {
      display: block;
      margin-bottom: 5px;
      color: var(--text-primary);
      font-size: 14px;
    }

    .input-group input {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      background-color: var(--background-light);
      color: var(--text-primary);
    }

    .input-group input::placeholder {
      color: var(--text-secondary);
      opacity: 0.7;
    }

    .input-group input:focus {
      border-color: var(--primary-color);
      outline: none;
      background-color: var(--background-main);
    }

    /* ç¤ºä¾‹æ–‡æœ¬æ ·å¼ */
    .input-group input[placeholder] {
      color: var(--text-primary);
    }

    .progress {
      margin: 15px 0;
      padding: 12px;
      background-color: var(--background-main);
      border-radius: 4px;
      font-size: 14px;
      color: var(--text-secondary);
      border: 1px solid var(--border-color);
    }

    .button-group {
      margin: 20px 0;
      display: flex;
      gap: 10px;
    }

    button {
      padding: 10px 24px;
      background-color: var(--primary-color);
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    button:hover {
      background-color: var(--primary-hover);
      box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3);
    }

    button:disabled {
      background-color: var(--secondary-color);
      cursor: not-allowed;
      opacity: 0.7;
    }

    #results,
    #markResult {
      margin-top: 20px;
      padding: 20px;
      background-color: var(--background-light);
      border-radius: 8px;
      font-family: 'Monaco', 'Consolas', monospace;
      white-space: pre;
      overflow-x: auto;
      max-height: 400px;
      overflow-y: auto;
      border: 1px solid var(--border-color);
      font-size: 14px;
      line-height: 1.5;
      color: var(--text-primary);
    }

    #imageCanvas {
      max-width: 100%;
      height: auto;
      margin-top: 20px;
      border: 1px solid #dee2e6;
      border-radius: 4px;
    }

    .copy-success {
      position: fixed;
      top: 20px;
      right: 20px;
      background: var(--success-color);
      color: white;
      padding: 10px 20px;
      border-radius: 4px;
      animation: fadeInOut 2s ease-in-out;
      z-index: 1000;
    }

    .summary {
      margin-top: 20px;
      padding: 20px;
      background-color: var(--background-main);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      display: flex;
      gap: 20px;
    }

    .summary-info {
      flex: 1;
    }

    .summary h3 {
      color: var(--text-primary);
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 1px solid var(--border-color);
    }

    .summary h4 {
      color: var(--text-primary);
      margin: 15px 0 10px;
    }

    .summary p {
      color: var(--text-secondary);
      margin: 5px 0;
      font-size: 14px;
    }

    .reason-group {
      margin-bottom: 20px;
      padding: 15px;
      background-color: var(--background-light);
      border: 1px solid var(--border-color);
      border-radius: 6px;
    }

    .summary ul {
      max-height: 300px;
      overflow-y: auto;
      list-style: none;
      padding: 10px;
      background-color: var(--background-main);
      border-radius: 4px;
    }

    .summary li {
      padding: 10px;
      border-bottom: 1px solid var(--border-color);
      cursor: pointer;
      transition: background-color 0.2s;
      color: var(--text-primary);
    }

    .summary li:hover {
      background-color: var(--background-light);
    }

    .summary li.active {
      background-color: var(--primary-color);
      color: white;
    }

    .summary li:last-child {
      border-bottom: none;
    }

    .summary li strong {
      color: var(--text-primary);
      display: block;
      margin-bottom: 5px;
    }

    /* é¢„è§ˆåŒºåŸŸæ ·å¼ */
    .summary-preview {
      flex: 1;
      background-color: var(--background-light);
      padding: 15px;
      border-radius: 8px;
      border: 1px solid var(--border-color);
    }

    .preview-image {
      max-width: 100%;
      max-height: 300px;
      object-fit: contain;
      border: 1px solid var(--border-color);
      border-radius: 4px;
      background-color: var(--background-main);
      display: none;
    }

    #previewCanvas {
      max-width: 100%;
      background-color: var(--background-main);
      border: 1px solid var(--border-color);
      border-radius: 4px;
    }

    #previewPlaceholder {
      color: var(--text-secondary);
      text-align: center;
      padding: 20px;
      background-color: var(--background-main);
      border-radius: 4px;
      border: 1px solid var(--border-color);
    }

    .summary-preview canvas {
      max-width: 100%;
      max-height: 500px;
      object-fit: contain;
      border: 1px solid #dee2e6;
      border-radius: 4px;
      display: none;
    }

    .summary {
      display: flex;
      gap: 20px;
    }

    .summary-info {
      flex: 1;
      overflow-y: auto;
      max-height: 80vh;
    }

    .summary-preview {
      flex: 1;
      position: sticky;
      top: 20px;
      align-self: flex-start;
    }

    .tab-container {
      margin-bottom: 30px;
      border-bottom: 1px solid var(--border-color);
    }

    .tab-buttons {
      display: flex;
      gap: 20px;
      padding: 0 20px;
    }

    .tab-button {
      padding: 12px 24px;
      border: none;
      background: none;
      cursor: pointer;
      font-size: 16px;
      color: var(--text-secondary);
      position: relative;
      transition: all 0.3s ease;
      font-weight: 500;
    }

    .tab-button:hover {
      color: var(--primary-color);
      background-color: rgba(26, 115, 232, 0.1);
      border-radius: 4px;
    }

    .tab-button.active {
      color: var(--primary-color);
    }

    .tab-button.active::after {
      content: '';
      position: absolute;
      bottom: -1px;
      left: 0;
      width: 100%;
      height: 3px;
      background-color: var(--primary-color);
      border-radius: 3px 3px 0 0;
    }

    .tab-content {
      display: none;
      opacity: 0;
      transition: opacity 0.3s ease-in-out;
    }

    .tab-content.active {
      display: block;
      opacity: 1;
    }

    /* æ‰‹æœºæ¨¡å‹æ ·å¼ */
    .phone-container {
      width: 100%;
      max-width: 430px;
      margin: 20px auto;
      position: relative;
      aspect-ratio: 9/19.5;
      background-color: var(--background-main);
      border: 2px solid var(--border-color);
      border-radius: 40px;
      overflow: hidden;
    }

    .phone-screen {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--background-light);
      border-radius: 35px;
      margin: 10px;
    }

    .phone-notch {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 150px;
      height: 25px;
      background-color: var(--background-main);
      border-bottom-left-radius: 15px;
      border-bottom-right-radius: 15px;
      z-index: 1;
    }

    .marking-area {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      cursor: crosshair;
      z-index: 2;
    }

    .nfc-marker {
      position: absolute;
      border: 2px solid #ff4444;
      background-color: rgba(255, 68, 68, 0.1);
      pointer-events: none;
      z-index: 3;
      display: none;
    }

    /* æ»‘å—æ ·å¼ */
    input[type="range"] {
      width: 100%;
      height: 4px;
      background: var(--border-color);
      border-radius: 2px;
      outline: none;
    }

    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 16px;
      height: 16px;
      background: var(--primary-color);
      border-radius: 50%;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    input[type="range"]::-webkit-slider-thumb:hover {
      background: var(--primary-hover);
    }

    .size-display {
      margin-top: 8px;
      color: var(--text-secondary);
      font-size: 14px;
    }

    #markResult {
      margin-top: 20px;
      padding: 20px;
      background: var(--background-light);
      border-radius: 8px;
      font-family: 'Monaco', 'Consolas', monospace;
      white-space: pre;
      overflow-x: auto;
      border: 1px solid var(--border-color);
      font-size: 14px;
      line-height: 1.5;
    }

    /* æ ‡è®°åŠŸèƒ½çš„è¯´æ˜æ ·å¼ */
    #markTab .instructions {
      margin: 20px 0;
      padding: 20px;
      background: #fff8e1;
      border: 1px solid #ffe082;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }

    #markTab .instructions h3 {
      color: #424242;
      margin-bottom: 16px;
      font-size: 16px;
      font-weight: 500;
      padding-bottom: 8px;
      border-bottom: 1px solid #ffe082;
    }

    #markTab .instructions ol {
      margin-left: 20px;
      color: #424242;
      counter-reset: item;
    }

    #markTab .instructions ol li {
      margin-bottom: 12px;
      line-height: 1.6;
      position: relative;
      padding-left: 8px;
    }

    #markTab .instructions ol li::marker {
      color: #fb8c00;
      font-weight: 500;
    }

    #markTab .instructions ul {
      margin: 8px 0 8px 24px;
      list-style-type: disc;
    }

    #markTab .instructions ul li {
      margin-bottom: 8px;
      color: #616161;
      font-size: 14px;
    }

    #markTab .instructions ul li::before {
      content: "â€¢";
      color: #fb8c00;
      font-weight: bold;
      display: inline-block;
      width: 1em;
      margin-left: -1em;
    }

    /* æ ‡è®°åŠŸèƒ½çš„æŒ‰é’®æ ·å¼ */
    #markTab .button-group {
      margin: 20px 0;
      display: flex;
      gap: 10px;
    }

    #markTab button {
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      transition: background-color 0.3s;
    }

    #markTab button:disabled {
      background-color: #6c757d;
      cursor: not-allowed;
    }

    #markTab button:not(:disabled):hover {
      opacity: 0.9;
    }

    /* æ ‡è®°åŠŸèƒ½çš„ä¸Šä¼ åŒºåŸŸæ ·å¼ */
    #markTab .upload-section {
      margin-bottom: 20px;
      padding: 20px;
      background-color: #f8f9fa;
      border-radius: 6px;
    }

    /* æ£€æµ‹åŠŸèƒ½çš„è¯´æ˜æ ·å¼ */
    #detectTab .instructions {
      margin: 20px 0;
      padding: 20px;
      background: #fff8e1;
      border: 1px solid #ffe082;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }

    #detectTab .instructions h3 {
      color: #424242;
      margin-bottom: 16px;
      font-size: 16px;
      font-weight: 500;
      padding-bottom: 8px;
      border-bottom: 1px solid #ffe082;
    }

    #detectTab .instructions ul {
      margin-left: 20px;
      color: #424242;
      list-style-type: none;
    }

    #detectTab .instructions li {
      margin-bottom: 12px;
      line-height: 1.6;
      position: relative;
      padding-left: 8px;
      color: #424242;
    }

    #detectTab .instructions li::before {
      content: "â€¢";
      color: #fb8c00;
      font-weight: bold;
      display: inline-block;
      width: 1em;
      margin-left: -1em;
    }

    .tab-content p {
      font-size: 16px;
      color: var(--text-primary);
      margin-bottom: 10px;
    }

    .tab-content ul {
      list-style-type: none;
    }

    .tab-content ul li {
      position: relative;
      padding-left: 20px;
      margin-bottom: 8px;
      line-height: 1.4;
    }

    .tab-content ul li::before {
      content: "â€¢";
      color: var(--primary-color);
      font-weight: bold;
      position: absolute;
      left: 0;
    }

    /* æ¨¡å‹è®­ç»ƒç›¸å…³æ ·å¼ */
    .train-section {
      margin: 20px 0;
    }

    .train-section h3 {
      font-size: 16px;
      color: var(--text-primary);
      margin-bottom: 15px;
      padding-bottom: 8px;
      border-bottom: 1px solid var(--border-color);
    }

    .dataset-upload,
    .model-config,
    .train-controls,
    .train-progress {
      margin-bottom: 30px;
      padding: 20px;
      background: var(--background-light);
      border-radius: 8px;
      border: 1px solid var(--border-color);
    }

    .config-group {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
    }

    .dataset-info {
      margin-top: 15px;
      padding: 10px;
      background-color: var(--background-main);
      border: 1px solid var(--border-color);
      border-radius: 4px;
      font-size: 14px;
      color: var(--text-secondary);
    }

    .progress-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }

    .progress-item {
      padding: 10px;
      background: white;
      border-radius: 4px;
      font-size: 14px;
    }

    .progress-item label {
      color: var(--text-secondary);
      margin-right: 8px;
    }

    #trainingChart {
      width: 100%;
      height: 300px;
      margin-top: 20px;
      background: white;
      border-radius: 4px;
      padding: 10px;
    }

    /* ä¸»é¢˜åˆ‡æ¢æŒ‰é’® */
    .theme-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 8px 16px;
      background-color: var(--background-main);
      border: 1px solid var(--border-color);
      border-radius: 20px;
      color: var(--text-primary);
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      z-index: 1000;
      transition: all 0.3s ease;
    }

    .theme-toggle:hover {
      background-color: var(--background-light);
    }

    .theme-toggle i {
      font-size: 16px;
    }

    /* ä¸Šä¼ åŒºåŸŸæ ·å¼ */
    .upload-section {
      margin-bottom: 20px;
      padding: 24px;
      background-color: var(--background-main);
      border-radius: 8px;
      border: 2px dashed var(--border-color);
    }

    /* æ‰‹åŠ¨æ ‡è®°å’Œæ‰¹é‡æ£€æµ‹çš„ä¸Šä¼ åŒºåŸŸ */
    #markTab .upload-section,
    #detectTab .upload-section,
    #trainTab .upload-section {
      background-color: var(--background-main);
    }

    /* æ–‡ä»¶ä¸Šä¼ æŒ‰é’®æ ·å¼ */
    .custom-file-upload {
      display: inline-block;
      padding: 10px 24px;
      background-color: var(--primary-color);
      color: white;
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 500;
    }

    .custom-file-upload:hover {
      background-color: var(--primary-hover);
    }

    /* è¾“å…¥æ¡†ç»„æ ·å¼ */
    .input-group {
      margin-bottom: 15px;
      padding: 10px;
      background-color: var(--background-main);
      border-radius: 4px;
    }

    /* è¿›åº¦æ˜¾ç¤ºæ ·å¼ */
    .progress {
      margin: 15px 0;
      padding: 12px;
      background-color: var(--background-main);
      border-radius: 4px;
      font-size: 14px;
      color: var(--text-secondary);
      border: 1px solid var(--border-color);
    }

    /* ç»“æœåŒºåŸŸæ ·å¼ */
    #results,
    #markResult {
      margin-top: 20px;
      padding: 20px;
      background-color: var(--background-light);
      border-radius: 8px;
      font-family: 'Monaco', 'Consolas', monospace;
      white-space: pre;
      overflow-x: auto;
      max-height: 400px;
      overflow-y: auto;
      border: 1px solid var(--border-color);
      font-size: 14px;
      line-height: 1.5;
      color: var(--text-primary);
    }

    /* æ¨¡å‹é…ç½®åŒºåŸŸæ ·å¼ */
    .model-config {
      background-color: var(--background-light);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
    }

    .config-group {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
    }

    /* æ•°æ®é›†ä¿¡æ¯æ ·å¼ */
    .dataset-info {
      margin-top: 15px;
      padding: 10px;
      background-color: var(--background-main);
      border: 1px solid var(--border-color);
      border-radius: 4px;
      font-size: 14px;
      color: var(--text-secondary);
    }

    /* è™šçº¿è¾¹æ¡†åŒºåŸŸæ ·å¼ */
    .dashed-border {
      border: 2px dashed var(--border-color);
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
      background-color: var(--background-light);
    }

    /* è®­ç»ƒè¿›åº¦åŒºåŸŸæ ·å¼ */
    .train-progress {
      margin: 20px 0;
      padding: 20px;
      background-color: var(--background-main);
      border-radius: 8px;
      border: 1px solid var(--border-color);
    }

    .progress-container {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      margin-bottom: 20px;
    }

    .progress-item {
      padding: 12px;
      background-color: var(--background-light);
      border: 1px solid var(--border-color);
      border-radius: 4px;
      text-align: center;
    }

    .progress-item label {
      display: block;
      margin-bottom: 5px;
      color: var(--text-secondary);
      font-size: 14px;
    }

    .progress-item span {
      color: var(--text-primary);
      font-size: 16px;
      font-weight: 500;
    }

    /* å›¾è¡¨åŒºåŸŸæ ·å¼ */
    #trainingChart {
      width: 100%;
      height: 300px;
      margin-top: 20px;
      background-color: var(--background-light);
      border: 1px solid var(--border-color);
      border-radius: 4px;
      padding: 15px;
    }

    /* è®­ç»ƒè¿›åº¦æ ‡é¢˜ */
    .train-progress h3 {
      color: var(--text-primary);
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 1px solid var(--border-color);
    }

    .train-guide {
      background: var(--background-main);
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      border: 1px solid var(--border-color);
    }

    .guide-steps {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .step {
      background: var(--background-light);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 20px;
      position: relative;
    }

    .step-number {
      position: absolute;
      top: -15px;
      left: -15px;
      width: 30px;
      height: 30px;
      background: var(--primary-color);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }

    .step h4 {
      margin-bottom: 10px;
      color: var(--text-primary);
    }

    .step pre {
      background: var(--background-main);
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
      font-size: 14px;
      color: var(--text-secondary);
      margin: 10px 0;
      border: 1px solid var(--border-color);
    }

    .info-item {
      display: flex;
      align-items: center;
      gap: 8px;
      margin: 5px 0;
      color: var(--text-secondary);
    }

    .info-item i {
      color: var(--primary-color);
    }

    .train-controls {
      display: flex;
      gap: 10px;
    }

    .train-controls button {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .train-controls button i {
      font-size: 18px;
    }

    .progress-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
    }

    .progress-item i {
      font-size: 24px;
      color: var(--primary-color);
    }

    /* è®­ç»ƒæŒ‡å—æ ·å¼ */
    .train-guide {
      background: var(--background-main);
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      border: 1px solid var(--border-color);
    }

    .guide-steps {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .step {
      background: var(--background-light);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 20px;
      position: relative;
    }

    .step-number {
      position: absolute;
      top: -15px;
      left: -15px;
      width: 30px;
      height: 30px;
      background: var(--primary-color);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }

    .step h4 {
      margin-bottom: 10px;
      color: var(--text-primary);
    }

    .step pre {
      background: var(--background-main);
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
      font-size: 14px;
      color: var(--text-secondary);
      margin: 10px 0;
      border: 1px solid var(--border-color);
    }

    /* ä¸Šä¼ åŒºåŸŸæ ·å¼ */
    .upload-content {
      padding: 20px;
      background: var(--background-light);
      border-radius: 8px;
      border: 1px solid var(--border-color);
    }

    .upload-area {
      border: 2px dashed var(--border-color);
      border-radius: 8px;
      padding: 30px;
      text-align: center;
      margin-bottom: 15px;
      background: var(--background-main);
      transition: all 0.3s ease;
    }

    .upload-area:hover {
      border-color: var(--primary-color);
      background: var(--background-light);
    }

    .upload-label {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      color: var(--text-secondary);
    }

    .upload-label i {
      font-size: 32px;
      color: var(--primary-color);
    }

    .upload-label span {
      font-size: 16px;
    }

    input[type="file"] {
      display: none;
    }

    .info-item {
      display: flex;
      align-items: center;
      gap: 8px;
      margin: 5px 0;
      color: var(--text-secondary);
    }

    .info-item i {
      color: var(--primary-color);
    }

    /* è®­ç»ƒè¿›åº¦æ ·å¼ */
    .progress-container {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      margin-bottom: 20px;
    }

    .progress-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
      padding: 15px;
      background: var(--background-light);
      border: 1px solid var(--border-color);
      border-radius: 8px;
    }

    .progress-item i {
      font-size: 24px;
      color: var(--primary-color);
    }

    .progress-item label {
      color: var(--text-secondary);
      font-size: 14px;
    }

    .progress-item span {
      font-size: 18px;
      font-weight: 500;
      color: var(--text-primary);
    }

    .train-controls {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }

    .train-controls button {
      display: flex;
      align-items: center;
      gap: 5px;
      padding: 10px 20px;
    }

    .train-controls button i {
      font-size: 18px;
    }

    #trainingChart {
      background: var(--background-light);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 15px;
      margin-top: 20px;
    }

    /* æ ‡æ³¨å·¥å…·æ ·å¼ */
    .annotation-guide {
      background: var(--background-main);
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      border: 1px solid var(--border-color);
    }

    .annotation-guide ol {
      margin-left: 20px;
      margin-top: 10px;
    }

    .annotation-guide li {
      color: var(--text-secondary);
      margin-bottom: 8px;
    }

    .annotation-area {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .annotation-workspace {
      background: var(--background-main);
      border-radius: 8px;
      padding: 20px;
      border: 1px solid var(--border-color);
    }

    .image-container {
      width: 100%;
      height: 500px;
      background: var(--background-light);
      border: 1px solid var(--border-color);
      border-radius: 4px;
      position: relative;
      overflow: hidden;
    }

    #annotationCanvas {
      position: absolute;
      top: 0;
      left: 0;
      cursor: crosshair;
    }

    .annotation-controls {
      margin-top: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .image-navigation {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .image-navigation button {
      display: flex;
      align-items: center;
      gap: 5px;
      padding: 8px 16px;
      background-color: var(--background-light);
      border: 1px solid var(--border-color);
      color: var(--text-primary);
    }

    .image-navigation button:hover:not(:disabled) {
      background-color: var(--background-main);
      border-color: var(--primary-color);
    }

    #imageProgress {
      color: var(--text-secondary);
      font-size: 14px;
      min-width: 60px;
      text-align: center;
    }

    .action-buttons {
      display: flex;
      gap: 10px;
    }

    .action-buttons button {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    #resetBoxBtn {
      background-color: var(--background-light);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
    }

    #resetBoxBtn:hover:not(:disabled) {
      background-color: var(--background-main);
      border-color: var(--primary-color);
    }

    #generateDatasetBtn {
      background-color: var(--primary-color);
      color: white;
    }

    #generateDatasetBtn:hover:not(:disabled) {
      background-color: var(--primary-hover);
    }

    .file-info {
      margin-top: 10px;
      padding: 10px;
      background: var(--background-main);
      border-radius: 4px;
      border: 1px solid var(--border-color);
    }

    /* æ£€æµ‹æ¨¡å¼é€‰æ‹©æ ·å¼ */
    .detection-mode {
      margin-bottom: 20px;
      padding: 20px;
      background-color: var(--background-light);
      border-radius: 8px;
      border: 1px solid var(--border-color);
    }

    .detection-mode h3 {
      margin-bottom: 15px;
      color: var(--text-primary);
      font-size: 16px;
    }

    .mode-options {
      display: flex;
      gap: 20px;
      margin-bottom: 15px;
    }

    .mode-options label {
      display: flex;
      align-items: center;
      gap: 8px;
      color: var(--text-primary);
      cursor: pointer;
    }

    .model-upload {
      margin-top: 15px;
      padding: 15px;
      background-color: var(--background-main);
      border-radius: 4px;
      border: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      gap: 15px;
    }

    #modelStatus {
      color: var(--text-secondary);
      font-size: 14px;
    }
  </style>
  <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
</head>


<body>
  <button class="theme-toggle" onclick="toggleTheme()">
    <i class="ri-sun-line light-icon"></i>
    <i class="ri-moon-line dark-icon" style="display: none;"></i>
    <span class="theme-text">åˆ‡æ¢ä¸»é¢˜</span>
  </button>
  <div class="container">
    <div class="main-content">
      <div class="header">
        <h1>NFCä½ç½®æ ‡è®°å·¥å…·</h1>
      </div>

      <div class="tab-container">
        <div class="tab-buttons">
          <button class="tab-button" data-tab="mark">æ‰‹åŠ¨æ ‡è®°</button>
          <button class="tab-button" data-tab="detect">æ‰¹é‡æ£€æµ‹</button>
          <button class="tab-button" data-tab="annotate">æ ‡æ³¨å·¥å…·</button>
          <button class="tab-button active" data-tab="train">æ¨¡å‹è®­ç»ƒ</button>
        </div>
      </div>

      <!-- æ ‡è®°åŠŸèƒ½çš„å†…å®¹ -->
      <div id="markTab" class="tab-content">
        <div class="upload-section">
          <div class="input-group">
            <label for="brand">æ‰‹æœºå“ç‰Œ</label>
            <input type="text" id="brand" placeholder="ä¾‹å¦‚ï¼šAPPLE">
          </div>
          <div class="input-group">
            <label for="model">æ‰‹æœºå‹å·</label>
            <input type="text" id="model" placeholder="ä¾‹å¦‚ï¼šIPHONE15">
          </div>
        </div>

        <div class="size-controls">
          <label for="aspectRatio">æ‰‹æœºå±å¹•æ¯”ä¾‹è°ƒæ•´</label>
          <input type="range" id="aspectRatio" min="16" max="22" value="19.5" step="0.5">
          <div class="size-display">å½“å‰æ¯”ä¾‹ï¼š9:19.5</div>
        </div>

        <div class="phone-container" id="phoneContainer">
          <div class="phone-screen"></div>
          <div class="phone-notch"></div>
          <div class="marking-area" id="markingArea"></div>
          <div class="nfc-marker" id="nfcMarker"></div>
        </div>

        <div class="button-group">
          <button id="generateBtn" disabled>ç”ŸæˆJSON</button>
          <button id="resetBtn">é‡ç½®</button>
          <button id="copyMarkBtn" disabled>å¤åˆ¶ç»“æœ</button>
          <button id="submitPRBtn" disabled>æäº¤PR</button>
        </div>

        <div id="markResult">æš‚æ— ç»“æœ</div>
      </div>

      <!-- æ£€æµ‹åŠŸèƒ½çš„å†…å®¹ -->
      <div id="detectTab" class="tab-content">
        <p>æ‰¹é‡æ£€æµ‹åŠŸèƒ½å¯ä»¥è‡ªåŠ¨åˆ†æå¤šä¸ªæ‰‹æœºå›¾ç‰‡ä¸­çš„NFCä½ç½®ï¼š</p>
        <ul style="margin: 10px 0 20px 20px; color: var(--text-secondary);">
          <li>æ”¯æŒæ‰¹é‡ä¸Šä¼ å¤šä¸ªå“ç‰Œå’Œå‹å·çš„æ‰‹æœºå›¾ç‰‡</li>
          <li>è‡ªåŠ¨è¯†åˆ«å›¾ç‰‡ä¸­å·²æ ‡è®°çš„NFCåŒºåŸŸï¼ˆçº¢è‰²æ¡†æ ‡è®°ï¼‰</li>
          <li>ç”Ÿæˆæ ‡å‡†æ ¼å¼çš„JSONæ•°æ®æ–‡ä»¶</li>
        </ul>

        <div class="detection-mode">
          <h3>æ£€æµ‹æ¨¡å¼é€‰æ‹©</h3>
          <div class="mode-options">
            <label>
              <input type="radio" name="detectionMode" value="traditional" checked>
              ä¼ ç»Ÿæ¨¡å¼ï¼ˆåŸºäºå›¾åƒå¤„ç†ï¼‰
            </label>
            <label>
              <input type="radio" name="detectionMode" value="model">
              AIæ¨¡å¼ï¼ˆä½¿ç”¨è®­ç»ƒæ¨¡å‹ï¼‰
            </label>
          </div>
          <div class="model-upload" style="display: none;">
            <label for="modelUpload">é€‰æ‹©æ¨¡å‹æ–‡ä»¶ï¼š</label>
            <input type="file" id="modelUpload" accept=".zip" style="display: none;">
            <button id="uploadModelBtn" class="custom-file-upload">ä¸Šä¼ æ¨¡å‹æ–‡ä»¶</button>
            <span id="modelStatus">æœªåŠ è½½æ¨¡å‹</span>
          </div>
        </div>

        <div class="upload-section">
          <div class="file-input-wrapper">
            <label class="custom-file-upload">
              <input type="file" id="folderInput" webkitdirectory directory multiple>
              é€‰æ‹©æ–‡ä»¶å¤¹
            </label>
          </div>
          <div class="progress">
            å¤„ç†è¿›åº¦ï¼š<span id="progress">0/0</span>
          </div>
        </div>

        <div class="button-group">
          <button id="downloadBtn" style="display:none;">ä¸‹è½½JSONç»“æœ</button>
          <button id="copyBtn" style="display:none;">å¤åˆ¶ç»“æœ</button>
        </div>

        <div id="results">æš‚æ— ç»“æœ</div>
        <canvas id="imageCanvas"></canvas>
      </div>

      <!-- æ ‡æ³¨å·¥å…·æ ‡ç­¾é¡µ -->
      <div id="annotateTab" class="tab-content">
        <div class="annotation-guide">
          <h3>ğŸ“ å›¾ç‰‡æ ‡æ³¨è¯´æ˜</h3>
          <ol>
            <li>é€‰æ‹©éœ€è¦æ ‡æ³¨çš„å›¾ç‰‡æ–‡ä»¶å¤¹</li>
            <li>åœ¨å›¾ç‰‡ä¸ŠæŒ‰ä½é¼ æ ‡å·¦é”®æ‹–åŠ¨æ¥æ¡†é€‰NFCåŒºåŸŸ</li>
            <li>è°ƒæ•´æ¡†é€‰åŒºåŸŸç›´åˆ°å‡†ç¡®åŒ…å«NFCä½ç½®</li>
            <li>ç‚¹å‡»"ç”Ÿæˆæ•°æ®é›†"æŒ‰é’®å¯¼å‡ºæ ‡æ³¨ç»“æœ</li>
          </ol>
        </div>

        <div class="annotation-area">
          <div class="upload-section">
            <h3>é€‰æ‹©å›¾ç‰‡</h3>
            <div class="upload-content">
              <div class="upload-area">
                <label class="upload-label" for="annotationInput">
                  <i class="ri-image-add-line"></i>
                  <span>é€‰æ‹©å›¾ç‰‡æ–‡ä»¶å¤¹</span>
                </label>
                <input type="file" id="annotationInput" webkitdirectory directory multiple accept="image/*">
              </div>
              <div class="file-info">
                <div class="info-item">
                  <i class="ri-image-line"></i>
                  <span>å·²é€‰æ‹©ï¼š<span id="imageCount">0</span> å¼ å›¾ç‰‡</span>
                </div>
              </div>
            </div>
          </div>

          <div class="annotation-workspace">
            <div class="image-container">
              <img id="currentImage" style="display: none;">
              <canvas id="annotationCanvas"></canvas>
            </div>
            <div class="annotation-controls">
              <div class="image-navigation">
                <button id="prevImageBtn" disabled>
                  <i class="ri-arrow-left-line"></i>
                  ä¸Šä¸€å¼ 
                </button>
                <span id="imageProgress">0/0</span>
                <button id="nextImageBtn" disabled>
                  ä¸‹ä¸€å¼ 
                  <i class="ri-arrow-right-line"></i>
                </button>
              </div>
              <div class="action-buttons">
                <button id="resetBoxBtn" disabled>
                  <i class="ri-refresh-line"></i>
                  é‡ç½®æ¡†é€‰
                </button>
                <button id="generateDatasetBtn" disabled>
                  <i class="ri-file-zip-line"></i>
                  ç”Ÿæˆæ•°æ®é›†
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- è®­ç»ƒæ ‡ç­¾é¡µ -->
      <div id="trainTab" class="tab-content active">
        <div class="train-guide">
          <h3>ğŸ¯ è®­ç»ƒæ•°æ®é›†è¦æ±‚</h3>
          <div class="guide-steps">
            <div class="step">
              <span class="step-number">1</span>
              <h4>æ•°æ®é›†ç»“æ„</h4>
              <p>è¯·æŒ‰ä»¥ä¸‹ç»“æ„å‡†å¤‡æ•°æ®é›†ï¼š</p>
              <pre>
è®­ç»ƒæ•°æ®/
  â”œâ”€â”€ annotations.json    # æ ‡æ³¨æ–‡ä»¶
  â””â”€â”€ images/            # å›¾ç‰‡æ–‡ä»¶å¤¹
      â”œâ”€â”€ phone1.jpg
      â”œâ”€â”€ phone2.jpg
      â””â”€â”€ ...
              </pre>
            </div>
            <div class="step">
              <span class="step-number">2</span>
              <h4>æ ‡æ³¨æ–‡ä»¶æ ¼å¼</h4>
              <p>annotations.json éœ€è¦åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š</p>
              <pre>
{
  "images": [
    {
      "file_name": "phone1.jpg",
      "annotations": {
        "x": 0.1,      # å·¦ä¸Šè§’xåæ ‡ (0-1)
        "y": 0.2,      # å·¦ä¸Šè§’yåæ ‡ (0-1)
        "width": 0.3,  # å®½åº¦ (0-1)
        "height": 0.4  # é«˜åº¦ (0-1)
      }
    },
    ...
  ]
}
              </pre>
            </div>
          </div>
        </div>

        <div class="dataset-upload">
          <h3>ğŸ“‚ æ•°æ®é›†ä¸Šä¼ </h3>
          <div class="upload-content">
            <div class="upload-area">
              <label class="upload-label" for="trainingDataInput">
                <i class="ri-folder-upload-line"></i>
                <span>é€‰æ‹©è®­ç»ƒæ•°æ®æ–‡ä»¶å¤¹</span>
              </label>
              <input type="file" id="trainingDataInput" webkitdirectory directory multiple>
            </div>
            <div class="dataset-info">
              <div class="info-item">
                <i class="ri-file-list-line"></i>
                <span>æ•°æ®é›†çŠ¶æ€ï¼š<span id="datasetCount">æœªé€‰æ‹©æ•°æ®é›†</span></span>
              </div>
            </div>
          </div>
        </div>

        <div class="train-progress">
          <h3>ğŸ“Š è®­ç»ƒè¿›åº¦</h3>
          <div class="progress-container">
            <div class="progress-item">
              <i class="ri-loop-left-line"></i>
              <label>å½“å‰è½®æ¬¡</label>
              <span id="currentEpoch">-</span>
            </div>
            <div class="progress-item">
              <i class="ri-error-warning-line"></i>
              <label>è®­ç»ƒæŸå¤±</label>
              <span id="trainLoss">-</span>
            </div>
            <div class="progress-item">
              <i class="ri-check-double-line"></i>
              <label>éªŒè¯å‡†ç¡®ç‡</label>
              <span id="valAccuracy">-</span>
            </div>
          </div>
          <canvas id="trainingChart"></canvas>
          <div class="train-controls">
            <button id="startTrainBtn" disabled>
              <i class="ri-play-circle-line"></i>
              å¼€å§‹è®­ç»ƒ
            </button>
            <button id="stopTrainBtn" disabled>
              <i class="ri-stop-circle-line"></i>
              åœæ­¢è®­ç»ƒ
            </button>
            <button id="exportModelBtn" disabled>
              <i class="ri-download-cloud-line"></i>
              å¯¼å‡ºæ¨¡å‹
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="instructions">
      <h2>ä½¿ç”¨è¯´æ˜</h2>
      <!-- æ‰‹åŠ¨æ ‡è®°çš„ä½¿ç”¨è¯´æ˜ -->
      <div class="instruction-content active" id="markInstructions">
        <ol>
          <li>è¾“å…¥æ‰‹æœºå“ç‰Œå’Œå‹å·ï¼ˆä¾‹å¦‚ï¼šAPPLE IPHONE15ï¼‰</li>
          <li>è°ƒæ•´æ‰‹æœºå±å¹•æ¯”ä¾‹ï¼ˆé»˜è®¤9:19.5ï¼‰</li>
          <li>åœ¨æ‰‹æœºæ¨¡å‹ä¸ŠæŒ‰ä½é¼ æ ‡å·¦é”®å¹¶æ‹–åŠ¨æ¥æ ‡è®°NFCåŒºåŸŸï¼ˆå°†æ˜¾ç¤ºä¸ºçº¢è‰²æ¡†ï¼‰</li>
          <li>ç‚¹å‡»"ç”ŸæˆJSON"æŒ‰é’®è·å–ç»“æœ</li>
          <li>æäº¤æ•°æ®å®¡æ ¸ï¼š
            <ul>
              <li>ç‚¹å‡»"æäº¤PR"æŒ‰é’®</li>
              <li>åœ¨æ‰“å¼€çš„GitHubé¡µé¢ä¸­ç¡®è®¤æ–‡ä»¶è·¯å¾„ï¼ˆdata/å“ç‰Œ/å‹å·.jsonï¼‰</li>
              <li>ç‚¹å‡»"Propose new file"æäº¤å®¡æ ¸</li>
            </ul>
          </li>
          <li>å¦‚éœ€é‡æ–°æ ‡è®°ï¼Œç‚¹å‡»"é‡ç½®"æŒ‰é’®</li>
        </ol>
      </div>
      
      <!-- æ‰¹é‡æ£€æµ‹çš„ä½¿ç”¨è¯´æ˜ -->
      <div class="instruction-content" id="detectInstructions">
        <ol>
          <li>é€‰æ‹©åŒ…å«æ‰‹æœºå›¾ç‰‡çš„æ–‡ä»¶å¤¹è¿›è¡Œä¸Šä¼ </li>
          <li>æ–‡ä»¶å¤¹ç»“æ„åº”ä¸ºï¼šå“ç‰Œ/å‹å·/å›¾ç‰‡æ–‡ä»¶</li>
          <li>æ”¯æŒçš„å›¾ç‰‡æ ¼å¼ï¼šPNGã€JPGã€JPEG</li>
          <li>å›¾ç‰‡åº”æ¸…æ™°æ˜¾ç¤ºæ‰‹æœºæ­£é¢ï¼Œä¸”NFCåŒºåŸŸéœ€è¦ç”¨çº¢è‰²æ¡†æ ‡è®°</li>
          <li>å¤„ç†å®Œæˆåå¯ä»¥ï¼š
            <ul>
              <li>ä¸‹è½½JSONç»“æœ</li>
              <li>å¤åˆ¶ç»“æœåˆ°å‰ªè´´æ¿</li>
              <li>æŸ¥çœ‹å¼‚å¸¸æ£€æµ‹ç»“æœè¯¦æƒ…</li>
            </ul>
          </li>
        </ol>
      </div>
      
      <!-- æ¨¡å‹è®­ç»ƒçš„ä½¿ç”¨è¯´æ˜ -->
      <div class="instruction-content" id="trainInstructions">
        <ol>
          <li>å‡†å¤‡è®­ç»ƒæ•°æ®é›†ï¼š
            <ul>
              <li>æŒ‰å“ç‰Œ/å‹å·æ•´ç†å›¾ç‰‡æ–‡ä»¶å¤¹</li>
              <li>ç¡®ä¿å›¾ç‰‡ä¸­NFCåŒºåŸŸå·²æ ‡è®°ï¼ˆçº¢æ¡†ï¼‰</li>
              <li>å»ºè®®è‡³å°‘å‡†å¤‡100å¼ æ ·æœ¬</li>
            </ul>
          </li>
          <li>ä¸Šä¼ æ•°æ®é›†æ–‡ä»¶å¤¹</li>
          <li>é…ç½®è®­ç»ƒå‚æ•°ï¼š
            <ul>
              <li>è®­ç»ƒè½®æ•°ï¼šå»ºè®®50-100è½®</li>
              <li>æ‰¹æ¬¡å¤§å°ï¼šæ ¹æ®è®¾å¤‡æ€§èƒ½è°ƒæ•´</li>
              <li>å­¦ä¹ ç‡ï¼šå»ºè®®ä»0.001å¼€å§‹</li>
            </ul>
          </li>
          <li>ç‚¹å‡»"å¼€å§‹è®­ç»ƒ"ï¼Œè§‚å¯Ÿè®­ç»ƒè¿›åº¦</li>
          <li>è®­ç»ƒå®Œæˆåå¯ä»¥ï¼š
            <ul>
              <li>å¯¼å‡ºè®­ç»ƒå¥½çš„æ¨¡å‹</li>
              <li>åœ¨æ£€æµ‹åŠŸèƒ½ä¸­ä½¿ç”¨æ¨¡å‹</li>
            </ul>
          </li>
        </ol>
      </div>
    </div>
  </div>

  <!-- å¼•å…¥å¿…è¦çš„åº“ -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.15.0/dist/tf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
  
  <!-- åˆå§‹åŒ–å…¨å±€å˜é‡ -->
  <script>
    // è®­ç»ƒç›¸å…³çš„å…¨å±€å˜é‡
    window.model = null;
    window.isTraining = false;
    window.trainingData = {
      images: [],
      labels: []
    };
  </script>

  <!-- å¼•å…¥è®­ç»ƒè„šæœ¬ -->
  <script src="train.js"></script>
  <script src="annotate.js"></script>

  <script>
    // Tabåˆ‡æ¢åŠŸèƒ½
    const tabButtons = document.querySelectorAll('.tab-button');
    const tabContents = document.querySelectorAll('.tab-content');
    const instructionContents = document.querySelectorAll('.instruction-content');

    tabButtons.forEach(button => {
      button.addEventListener('click', () => {
        // ç§»é™¤æ‰€æœ‰activeç±»
        tabButtons.forEach(btn => btn.classList.remove('active'));
        tabContents.forEach(content => content.classList.remove('active'));
        instructionContents.forEach(content => content.classList.remove('active'));

        // æ·»åŠ activeç±»åˆ°å½“å‰é€‰ä¸­çš„tab
        button.classList.add('active');
        const tabId = button.getAttribute('data-tab');
        document.getElementById(tabId + 'Tab').classList.add('active');
        
        // æ£€æŸ¥è¯´æ˜å…ƒç´ æ˜¯å¦å­˜åœ¨
        const instructionElement = document.getElementById(tabId + 'Instructions');
        if (instructionElement) {
            instructionElement.classList.add('active');
        }

        // é‡ç½®ä¸¤ä¸ªtabçš„çŠ¶æ€
        if (tabId === 'detect') {
          // é‡ç½®æ£€æµ‹tabçš„çŠ¶æ€
          if (typeof resetDetectTab === 'function') {
            resetDetectTab();
          }
        } else {
          // é‡ç½®æ ‡è®°tabçš„çŠ¶æ€
          if (typeof resetMarker === 'function') {
            resetMarker();
          }
        }
      });
    });

    // é˜²æ­¢ä¸¤ä¸ªtabçš„åŠŸèƒ½äº’ç›¸å¹²æ‰°
    function resetDetectTab() {
      // é‡ç½®æ£€æµ‹ç›¸å…³çš„å˜é‡å’Œæ˜¾ç¤º
      if (typeof allResults !== 'undefined') {
        allResults = [];
        unmatchedImages = [];
        totalFiles = 0;
        processedFiles = 0;
        updateResults(allResults);
        updateProgress();

        const oldSummary = document.querySelector('.summary');
        if (oldSummary) {
          oldSummary.remove();
        }
      }
    }

    // ç¡®ä¿ä¸¤ä¸ªtabçš„è„šæœ¬ä¸ä¼šå‘½åå†²çª
    const detectScript = document.createElement('script');
    detectScript.src = 'detect.js';  // å°†åŸ index.html çš„è„šæœ¬éƒ¨åˆ†ç§»åˆ°è¿™ä¸ªæ–‡ä»¶
    document.body.appendChild(detectScript);

    const markScript = document.createElement('script');
    markScript.src = 'mark.js';  // å°†åŸ mark.html çš„è„šæœ¬éƒ¨åˆ†ç§»åˆ°è¿™ä¸ªæ–‡ä»¶
    document.body.appendChild(markScript);

    // ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½
    function toggleTheme() {
      const body = document.documentElement;
      const lightIcon = document.querySelector('.light-icon');
      const darkIcon = document.querySelector('.dark-icon');
      const themeText = document.querySelector('.theme-text');
      
      if (body.getAttribute('data-theme') === 'dark') {
        // åˆ‡æ¢åˆ°äº®è‰²ä¸»é¢˜
        body.removeAttribute('data-theme');
        lightIcon.style.display = 'none';
        darkIcon.style.display = 'block';
        themeText.textContent = 'æ·±è‰²æ¨¡å¼';
        localStorage.setItem('theme', 'light');
      } else {
        // åˆ‡æ¢åˆ°æš—è‰²ä¸»é¢˜
        body.setAttribute('data-theme', 'dark');
        lightIcon.style.display = 'block';
        darkIcon.style.display = 'none';
        themeText.textContent = 'æµ…è‰²æ¨¡å¼';
        localStorage.setItem('theme', 'dark');
      }
    }

    // åˆå§‹åŒ–ä¸»é¢˜
    function initTheme() {
      const savedTheme = localStorage.getItem('theme') || 'light';
      const body = document.documentElement;
      const lightIcon = document.querySelector('.light-icon');
      const darkIcon = document.querySelector('.dark-icon');
      const themeText = document.querySelector('.theme-text');

      if (savedTheme === 'dark') {
        body.setAttribute('data-theme', 'dark');
        lightIcon.style.display = 'block';
        darkIcon.style.display = 'none';
        themeText.textContent = 'æµ…è‰²æ¨¡å¼';
      } else {
        lightIcon.style.display = 'none';
        darkIcon.style.display = 'block';
        themeText.textContent = 'æ·±è‰²æ¨¡å¼';
      }
    }

    // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–ä¸»é¢˜
    document.addEventListener('DOMContentLoaded', initTheme);
  </script>
</body>

</html>